<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Welcome to day 3!!! | Non-Linear Models for the Plant Sciences</title>
  <meta name="description" content="<p>An applied introduction to nonlinear models for the plant sciences, with
emphasis on interpretation, uncertainty, and conscient implementation in R.</p>" />
  <meta name="generator" content="bookdown 0.46 and GitBook 2.6.7" />

  <meta property="og:title" content="Welcome to day 3!!! | Non-Linear Models for the Plant Sciences" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="<p>An applied introduction to nonlinear models for the plant sciences, with
emphasis on interpretation, uncertainty, and conscient implementation in R.</p>" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Welcome to day 3!!! | Non-Linear Models for the Plant Sciences" />
  
  <meta name="twitter:description" content="<p>An applied introduction to nonlinear models for the plant sciences, with
emphasis on interpretation, uncertainty, and conscient implementation in R.</p>" />
  

<meta name="author" content="Claudio Dias da Silva Jr &amp; Trevor Hefley" />


<meta name="date" content="2026-01-27" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="welcome-to-day-2.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/codefolding-lua-1.1/codefolding-lua.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Nonlinear Models for the Plant Sciences</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#motivation"><i class="fa fa-check"></i>Motivation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="welcome-to-day-1.html"><a href="welcome-to-day-1.html"><i class="fa fa-check"></i>Welcome to day 1!</a>
<ul>
<li class="chapter" data-level="" data-path="welcome-to-day-1.html"><a href="welcome-to-day-1.html#linear-models"><i class="fa fa-check"></i>Linear models</a>
<ul>
<li class="chapter" data-level="" data-path="welcome-to-day-1.html"><a href="welcome-to-day-1.html#what-is-and-what-isnt-a-linear-model"><i class="fa fa-check"></i>1. What is and what isn’t a linear model</a></li>
<li class="chapter" data-level="" data-path="welcome-to-day-1.html"><a href="welcome-to-day-1.html#estimation-and-inference-a-linear-model-example"><i class="fa fa-check"></i>2. Estimation and Inference: A linear model example</a></li>
<li class="chapter" data-level="" data-path="welcome-to-day-1.html"><a href="welcome-to-day-1.html#i.-loss-function-approach"><i class="fa fa-check"></i>I. Loss function approach</a></li>
<li class="chapter" data-level="" data-path="welcome-to-day-1.html"><a href="welcome-to-day-1.html#ii.-likelihood-based-approach"><i class="fa fa-check"></i>II. Likelihood-based approach</a></li>
<li class="chapter" data-level="" data-path="welcome-to-day-1.html"><a href="welcome-to-day-1.html#iii.-bayesian-approach"><i class="fa fa-check"></i>III. Bayesian approach</a></li>
<li class="chapter" data-level="" data-path="welcome-to-day-1.html"><a href="welcome-to-day-1.html#why-use-bayesian"><i class="fa fa-check"></i>3. Why use Bayesian?</a></li>
<li class="chapter" data-level="" data-path="welcome-to-day-1.html"><a href="welcome-to-day-1.html#practice-for-day-1"><i class="fa fa-check"></i>4. Practice for day 1</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="welcome-to-day-2.html"><a href="welcome-to-day-2.html"><i class="fa fa-check"></i>Welcome to Day 2!!</a>
<ul>
<li class="chapter" data-level="" data-path="welcome-to-day-2.html"><a href="welcome-to-day-2.html#nonlinear-models"><i class="fa fa-check"></i>Nonlinear models</a>
<ul>
<li class="chapter" data-level="" data-path="welcome-to-day-2.html"><a href="welcome-to-day-2.html#exercises-from-day-1"><i class="fa fa-check"></i>1. Exercises from day 1</a></li>
<li class="chapter" data-level="" data-path="welcome-to-day-2.html"><a href="welcome-to-day-2.html#working-with-weakly-identifiable-parameters"><i class="fa fa-check"></i>2. Working with weakly identifiable parameters</a></li>
<li class="chapter" data-level="" data-path="welcome-to-day-2.html"><a href="welcome-to-day-2.html#summary"><i class="fa fa-check"></i>3. Summary</a></li>
<li class="chapter" data-level="" data-path="welcome-to-day-2.html"><a href="welcome-to-day-2.html#practice-questions"><i class="fa fa-check"></i>4. Practice questions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="welcome-to-day-3.html"><a href="welcome-to-day-3.html"><i class="fa fa-check"></i>Welcome to day 3!!!</a>
<ul>
<li class="chapter" data-level="" data-path="welcome-to-day-3.html"><a href="welcome-to-day-3.html#bayesian-nonlinear-models"><i class="fa fa-check"></i>Bayesian Nonlinear models</a>
<ul>
<li class="chapter" data-level="" data-path="welcome-to-day-3.html"><a href="welcome-to-day-3.html#exercises-from-day-2"><i class="fa fa-check"></i>1. Exercises from day 2</a></li>
<li class="chapter" data-level="" data-path="welcome-to-day-3.html"><a href="welcome-to-day-3.html#bayesian-nonlinear-models-1"><i class="fa fa-check"></i>2. Bayesian nonlinear models</a></li>
<li class="chapter" data-level="" data-path="welcome-to-day-3.html"><a href="welcome-to-day-3.html#wrap-up"><i class="fa fa-check"></i>3. Wrap-up</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/ClaudioDSJr11/Non-Linear-Models-for-the-Plant-Sciences" target="_blank">View source on GitHub</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Non-Linear Models for the Plant Sciences</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="welcome-to-day-3" class="section level1 hasAnchor">
<h1>Welcome to day 3!!!<a href="welcome-to-day-3.html#welcome-to-day-3" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>What have we learned so far?</p>
<ul>
<li><p>Day 1</p>
<ul>
<li><p>What is and what isn’t a linear model.</p></li>
<li><p>Estimation methods: Loss function; Likelihood-based; Bayesian.</p></li>
<li><p>When they are similar (e.g. normal errors).</p></li>
</ul></li>
<li><p>Day 2</p>
<ul>
<li><p>Linearization -&gt; From a curve, to a line… to a curve.</p></li>
<li><p>Mechanistic and Phenomenological models -&gt; Describe what causes patterns vs Describe the patterns.</p></li>
<li><p>Practical identifiability of parameters -&gt; When our data cannot inform our model parameters.</p>
<ul>
<li><p>How to work with weak identifiability:</p>
<ul>
<li><p>Fixing parameters.</p></li>
<li><p>Simplifying the model.</p></li>
</ul></li>
</ul></li>
</ul></li>
</ul>
<p><br><br></p>
<div id="bayesian-nonlinear-models" class="section level2 hasAnchor">
<h2>Bayesian Nonlinear models<a href="welcome-to-day-3.html#bayesian-nonlinear-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div>
<p><strong>Outline:</strong></p>
<ol style="list-style-type: decimal">
<li><p>Exercises from day 2</p>
<ul>
<li>Questions I and IV - Model selection, why?</li>
</ul></li>
<li><p>Bayesian nonlinear models</p>
<ul>
<li>Bayesian logistic disease progress curve</li>
<li>Why use Bayesian?</li>
</ul></li>
<li><p>Wrap-up</p></li>
</ol>
<p><strong>What is day 3 about?</strong></p>
<p>Imposing constraint on parameters using prior knowledge is done using Bayesian statistics. In Bayesian models, this is done through probabilistic assumptions on parameters, making uncertainty and modeling decisions explicit, while supporting biologically driven decisions.</p>
</div>
<p><br><br></p>
<div id="exercises-from-day-2" class="section level3 hasAnchor">
<h3>1. Exercises from day 2<a href="welcome-to-day-3.html#exercises-from-day-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="questions-i-and-iv---model-selection-why" class="section level4 hasAnchor">
<h4>Questions I and IV - Model selection, why?<a href="welcome-to-day-3.html#questions-i-and-iv---model-selection-why" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>I.</strong> For 2023, fit the nonlinear logistic model to variety a and b. Extract <span class="math inline">\(K\)</span> and <span class="math inline">\(r\)</span> and discuss the effect of genetic resistance in these parameters.</p>
<p><img src="_main_files/figure-html/unnamed-chunk-52-1.png" alt="" width="672" /></p>
<table class="table" style="color: black; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;">
Variety
</th>
<th style="text-align:center;">
K
</th>
<th style="text-align:center;">
r
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
a
</td>
<td style="text-align:center;">
0.6684032
</td>
<td style="text-align:center;">
0.3361402
</td>
</tr>
<tr>
<td style="text-align:center;">
b
</td>
<td style="text-align:center;">
0.5085910
</td>
<td style="text-align:center;">
0.3623941
</td>
</tr>
</tbody>
</table>
<p><strong>VI.</strong> Repeat question <strong>I</strong> for 2024.</p>
<p>How did it go? More specifically, where you able to fit it for variety b?</p>
<p>What we have:</p>
<p><img src="_main_files/figure-html/unnamed-chunk-54-1.png" alt="" width="672" /></p>
<p>What we expect:</p>
<p><img src="_main_files/figure-html/unnamed-chunk-55-1.png" alt="" width="672" /></p>
<ul>
<li>The blue line represents an exponential model:</li>
</ul>
<p><span class="math display">\[
y_i = y_0*e^{r_e*x_i}
\]</span></p>
<p>Why don’t we use this model instead? I have been pushing the logistic model for this data, even if it might not be the one that “best fit” it. Why?</p>
<ul>
<li>Discussion</li>
</ul>
<p><br><br></p>
</div>
</div>
<div id="bayesian-nonlinear-models-1" class="section level3 hasAnchor">
<h3>2. Bayesian nonlinear models<a href="welcome-to-day-3.html#bayesian-nonlinear-models-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>Data alone was insufficient, we need more assumptions!</p></li>
<li><p>A parallel with day 2:</p>
<ul>
<li><p>When data was insufficient, we made assumptions:</p>
<ul>
<li><p><span class="math inline">\(K = 1\)</span> + Nonlinear logistic model.</p></li>
<li><p><span class="math inline">\(K = 1\)</span> + Linearization.</p>
<ul>
<li><p>Assume the nonlinear relationship is well approximated by a linear one.</p></li>
<li><p>Assume inference on linearized model parameters is equivalent to the nonlinear.</p></li>
<li><p>Mechanistic meaning of the nonlinear model is preserved.</p></li>
</ul></li>
</ul></li>
</ul></li>
</ul>
<p>*Bayesian makes assumptions explicit vs previous approaches.</p>
<p><br><br></p>
<p>When using a Bayesian approach, we will be making assumptions, but not as deterministic as <span class="math inline">\(K = 1\)</span>, or changing the model structure.</p>
<p>We will treat all parameters as <strong>random variables</strong>. What does it mean?</p>
<ul>
<li>When we write the model:</li>
</ul>
<p><span class="math display">\[
y_i = \beta_0 + \beta_1*x_i + \varepsilon_i \\[10pt] \varepsilon_i \sim N(0, \sigma^2)
\]</span></p>
<ul>
<li>Is equivalent to write:</li>
</ul>
<p><span class="math display">\[
y_i \sim N(\mu_i, \sigma^2) \\[10pt] \mu_i = \beta_0 + \beta_1*x_i
\]</span></p>
<p>And this reads: <span class="math inline">\(y_i\)</span> arises from a normal distribution with <strong>expectation</strong> controlled by the mathematical model and variance <span class="math inline">\(\sigma^2\)</span>.</p>
<ul>
<li>What is expectation? It is <strong>where the distribution centers</strong>, the <strong>mean</strong>.</li>
</ul>
<p><span class="math inline">\(\mathbf{y}\)</span> is a random variable<a href="#fn8" class="footnote-ref" id="fnref8"><sup>8</sup></a> that arises from a distribution.</p>
<p>Now, what have we been doing so far with the logistic model?</p>
<p><span class="math display">\[
y_i \sim N(\mu_i, \sigma^2) \\[10pt] \mu_i = \frac{K}{1+(\frac{K-y_0}{y_0})*e^{-r*x_i}}
\]</span></p>
<ul>
<li><p>This is not Bayesian.</p></li>
<li><p>Recall, under this assumption: LS = ML</p></li>
<li><p>This is not working because of weak identifiability.</p></li>
<li><p>But we want this logistic equation, let’s make more assumptions!</p></li>
</ul>
<p><br><br></p>
<div id="bayesian-logistic-disease-progress-curve" class="section level4 hasAnchor">
<h4>Bayesian logistic disease progress curve<a href="welcome-to-day-3.html#bayesian-logistic-disease-progress-curve" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The first assumption we can make regards our response variable.</p>
<p>Is our model matching the data generating process?</p>
<ul>
<li><p>Severity = Proportion -&gt; Bounded 0 - 1</p></li>
<li><p>Beta distribution (Beta regression - <a href="https://www.tandfonline.com/doi/abs/10.1080/0266476042000214501">Ferrari &amp; Cribari-Neto, 2010</a>).</p></li>
</ul>
<p><span class="math display">\[
y_i \sim Beta(\mu_i, \phi) \\[10pt] \mu_i = \frac{K}{1+(\frac{K-y_0}{y_0})*e^{-r*x_i}}
\]</span></p>
<ul>
<li><p>This still not Bayesian. We are just choosing a more appropriate distribution for our response variable.</p>
<ul>
<li>We can do that using likelihood-based estimation.</li>
</ul></li>
</ul>
<p><strong>Now, let’s get Bayesian!</strong></p>
<p>We will treat our unknown quantities (parameters) as random variables. How does it work?</p>
<p>Recall the assumption: <span class="math inline">\(K = 1\)</span></p>
<p>It is the same as: <span class="math inline">\(K \sim N(1, 0)\)</span></p>
<ul>
<li>This is the strongest and most restrictive assumption!</li>
</ul>
<p>If we “relax” this assumption, and let <span class="math inline">\(K\)</span> vary a little more, let’s say <span class="math inline">\(K \sim N(1, 5)\)</span>, this what happens:</p>
<p><img src="_main_files/figure-html/unnamed-chunk-56-1.png" alt="" width="672" /></p>
<p>Now, do you think these values make sense?</p>
<ul>
<li><p><span class="math inline">\(K\)</span> has a biological meaning - Maximum disease potential.</p></li>
<li><p>What if we impose a constraint on this parameter?</p></li>
</ul>
<p><span class="math display">\[
K \sim Beta(6, 2)
\]</span></p>
<p><img src="_main_files/figure-html/unnamed-chunk-57-1.png" alt="" width="672" /></p>
<p>How we are choosing that?</p>
<ul>
<li><p>Beta distribution - Bounds.</p></li>
<li><p>Leaning towards higher values - <span class="math inline">\(K\)</span> represents the maximum disease potential.</p></li>
<li><p>Let it vary from very small maximum to the maximum possible (1).</p></li>
</ul>
<p><br><br></p>
<center>
<p><strong>This is what we call prior distribution, we use prior knowledge to inform unknown quantities in the model.</strong></p>
<p><strong>“Before we see the data, what values we expect this parameter to assume?”</strong></p>
</center>
<p><br><br></p>
<p>Priors are constructed using:</p>
<ul>
<li><p>Expert knowledge.</p></li>
<li><p>Published information.</p></li>
</ul>
<p><br><br></p>
<p>How does it look like for our remaining parameters?</p>
<p><span class="math inline">\(y_0\)</span> ~ <span class="math inline">\(Unif(0.001, 0.1)\)</span></p>
<p><img src="_main_files/figure-html/unnamed-chunk-58-1.png" alt="" width="672" /></p>
<p><span class="math inline">\(r\)</span> ~ <span class="math inline">\(Unif(0.1, 0.5)\)</span></p>
<p><img src="_main_files/figure-html/unnamed-chunk-59-1.png" alt="" width="672" /></p>
<p><span class="math inline">\(\phi\)</span> ~ <span class="math inline">\(Gamma(24, 2)\)</span></p>
<p><img src="_main_files/figure-html/unnamed-chunk-60-1.png" alt="" width="672" /></p>
<ul>
<li>Dispersion parameter ~ Inverse of the variance</li>
</ul>
<p><br><br></p>
<p><strong>We end up with this Bayesian model:</strong></p>
<p><span class="math display">\[
y_i \sim Beta(\mu_i, \phi) \\[10pt] \mu_i = \frac{K}{1 + (\frac{K - y_0}{y_0})*e^{-r*x_i}} \\[20pt] K \sim Beta(6, 2) \\[10pt] y_0 \sim Unif(0.001, 0.1) \\[10pt] r \sim Unif(0.1, 0.5) \\[10pt] \phi \sim Gamma(24, 2)
\]</span></p>
<p><br><br></p>
<p>Let’s fit the model for the variety b in 2024:</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="welcome-to-day-3.html#cb40-1" tabindex="-1"></a><span class="fu">library</span>(rjags)</span>
<span id="cb40-2"><a href="welcome-to-day-3.html#cb40-2" tabindex="-1"></a><span class="fu">library</span>(coda)</span>
<span id="cb40-3"><a href="welcome-to-day-3.html#cb40-3" tabindex="-1"></a></span>
<span id="cb40-4"><a href="welcome-to-day-3.html#cb40-4" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2026</span>)</span>
<span id="cb40-5"><a href="welcome-to-day-3.html#cb40-5" tabindex="-1"></a></span>
<span id="cb40-6"><a href="welcome-to-day-3.html#cb40-6" tabindex="-1"></a>y <span class="ot">&lt;-</span> df[<span class="fu">which</span>(df<span class="sc">$</span>year <span class="sc">==</span> <span class="dv">2024</span> <span class="sc">&amp;</span> df<span class="sc">$</span>var <span class="sc">==</span> <span class="st">&quot;b&quot;</span>),]<span class="sc">$</span>p_sev <span class="sc">+</span> <span class="fl">0.001</span></span>
<span id="cb40-7"><a href="welcome-to-day-3.html#cb40-7" tabindex="-1"></a>x <span class="ot">&lt;-</span> df[<span class="fu">which</span>(df<span class="sc">$</span>year <span class="sc">==</span> <span class="dv">2024</span> <span class="sc">&amp;</span> df<span class="sc">$</span>var <span class="sc">==</span> <span class="st">&quot;b&quot;</span>),]<span class="sc">$</span>time</span>
<span id="cb40-8"><a href="welcome-to-day-3.html#cb40-8" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">nrow</span>(df[<span class="fu">which</span>(df<span class="sc">$</span>year <span class="sc">==</span> <span class="dv">2024</span> <span class="sc">&amp;</span> df<span class="sc">$</span>var <span class="sc">==</span> <span class="st">&quot;b&quot;</span>),])</span>
<span id="cb40-9"><a href="welcome-to-day-3.html#cb40-9" tabindex="-1"></a>x.pred <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">max</span>(x)<span class="sc">+</span><span class="dv">20</span>, <span class="at">by =</span> <span class="dv">1</span>)</span>
<span id="cb40-10"><a href="welcome-to-day-3.html#cb40-10" tabindex="-1"></a>N_pred <span class="ot">&lt;-</span> <span class="fu">length</span>(x.pred)</span>
<span id="cb40-11"><a href="welcome-to-day-3.html#cb40-11" tabindex="-1"></a></span>
<span id="cb40-12"><a href="welcome-to-day-3.html#cb40-12" tabindex="-1"></a><span class="co"># JAGS code</span></span>
<span id="cb40-13"><a href="welcome-to-day-3.html#cb40-13" tabindex="-1"></a>data_line <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;y&quot;</span> <span class="ot">=</span> y, <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x, <span class="st">&quot;x.pred&quot;</span> <span class="ot">=</span> x.pred, <span class="st">&quot;N&quot;</span> <span class="ot">=</span> N, <span class="st">&quot;N_pred&quot;</span> <span class="ot">=</span> N_pred)</span>
<span id="cb40-14"><a href="welcome-to-day-3.html#cb40-14" tabindex="-1"></a>initials <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb40-15"><a href="welcome-to-day-3.html#cb40-15" tabindex="-1"></a>  <span class="fu">list</span>(<span class="st">&quot;K&quot;</span> <span class="ot">=</span> <span class="fl">0.7</span>, <span class="st">&quot;r&quot;</span> <span class="ot">=</span> <span class="fl">0.2</span>, <span class="st">&quot;y0&quot;</span> <span class="ot">=</span> <span class="fl">0.001</span>, <span class="st">&quot;phi&quot;</span> <span class="ot">=</span> <span class="dv">10</span>)</span>
<span id="cb40-16"><a href="welcome-to-day-3.html#cb40-16" tabindex="-1"></a>)</span>
<span id="cb40-17"><a href="welcome-to-day-3.html#cb40-17" tabindex="-1"></a></span>
<span id="cb40-18"><a href="welcome-to-day-3.html#cb40-18" tabindex="-1"></a>model_string <span class="ot">&lt;-</span> <span class="st">&quot;model {</span></span>
<span id="cb40-19"><a href="welcome-to-day-3.html#cb40-19" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb40-20"><a href="welcome-to-day-3.html#cb40-20" tabindex="-1"></a><span class="st">    # Likelihood</span></span>
<span id="cb40-21"><a href="welcome-to-day-3.html#cb40-21" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb40-22"><a href="welcome-to-day-3.html#cb40-22" tabindex="-1"></a><span class="st">    for(i in 1:N){</span></span>
<span id="cb40-23"><a href="welcome-to-day-3.html#cb40-23" tabindex="-1"></a><span class="st">      y[i] ~ dbeta(alpha[i], beta[i])</span></span>
<span id="cb40-24"><a href="welcome-to-day-3.html#cb40-24" tabindex="-1"></a><span class="st">      alpha[i] &lt;- (K/(1 + ((K-y0)/y0)*exp(-r*x[i])))*phi</span></span>
<span id="cb40-25"><a href="welcome-to-day-3.html#cb40-25" tabindex="-1"></a><span class="st">      beta[i] &lt;- (1-(K/(1 + ((K-y0)/y0)*exp(-r*x[i]))))*phi</span></span>
<span id="cb40-26"><a href="welcome-to-day-3.html#cb40-26" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb40-27"><a href="welcome-to-day-3.html#cb40-27" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb40-28"><a href="welcome-to-day-3.html#cb40-28" tabindex="-1"></a><span class="st">    # Posterior pred.</span></span>
<span id="cb40-29"><a href="welcome-to-day-3.html#cb40-29" tabindex="-1"></a><span class="st">      for(z in 1:N_pred){</span></span>
<span id="cb40-30"><a href="welcome-to-day-3.html#cb40-30" tabindex="-1"></a><span class="st">        y_pred[z] ~ dbeta(alpha_pred[z], beta_pred[z])</span></span>
<span id="cb40-31"><a href="welcome-to-day-3.html#cb40-31" tabindex="-1"></a><span class="st">        alpha_pred[z] &lt;- (K/(1 + ((K-y0)/y0)*exp(-r*x.pred[z])))*phi</span></span>
<span id="cb40-32"><a href="welcome-to-day-3.html#cb40-32" tabindex="-1"></a><span class="st">        beta_pred[z] &lt;- (1-(K/(1 + ((K-y0)/y0)*exp(-r*x.pred[z]))))*phi</span></span>
<span id="cb40-33"><a href="welcome-to-day-3.html#cb40-33" tabindex="-1"></a><span class="st">      }</span></span>
<span id="cb40-34"><a href="welcome-to-day-3.html#cb40-34" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb40-35"><a href="welcome-to-day-3.html#cb40-35" tabindex="-1"></a><span class="st">    # Priors</span></span>
<span id="cb40-36"><a href="welcome-to-day-3.html#cb40-36" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb40-37"><a href="welcome-to-day-3.html#cb40-37" tabindex="-1"></a><span class="st">    y0 ~ dunif(0.001, 0.1)</span></span>
<span id="cb40-38"><a href="welcome-to-day-3.html#cb40-38" tabindex="-1"></a><span class="st">    K ~ dbeta(6, 2)</span></span>
<span id="cb40-39"><a href="welcome-to-day-3.html#cb40-39" tabindex="-1"></a><span class="st">    r ~ dunif(0.1, 0.5)</span></span>
<span id="cb40-40"><a href="welcome-to-day-3.html#cb40-40" tabindex="-1"></a><span class="st">    phi ~ dgamma(24, 2)</span></span>
<span id="cb40-41"><a href="welcome-to-day-3.html#cb40-41" tabindex="-1"></a><span class="st">}&quot;</span></span>
<span id="cb40-42"><a href="welcome-to-day-3.html#cb40-42" tabindex="-1"></a></span>
<span id="cb40-43"><a href="welcome-to-day-3.html#cb40-43" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">jags.model</span>(<span class="fu">textConnection</span>(model_string), <span class="at">inits =</span> initials, <span class="at">data =</span> data_line, <span class="at">n.chains =</span> <span class="dv">1</span>)</span>
<span id="cb40-44"><a href="welcome-to-day-3.html#cb40-44" tabindex="-1"></a></span>
<span id="cb40-45"><a href="welcome-to-day-3.html#cb40-45" tabindex="-1"></a><span class="fu">update</span>(m1, <span class="at">n.iter =</span> <span class="dv">10000</span>)</span>
<span id="cb40-46"><a href="welcome-to-day-3.html#cb40-46" tabindex="-1"></a></span>
<span id="cb40-47"><a href="welcome-to-day-3.html#cb40-47" tabindex="-1"></a>samples <span class="ot">&lt;-</span> <span class="fu">coda.samples</span>(m1, <span class="at">variable.names =</span> <span class="fu">c</span>(<span class="st">&quot;K&quot;</span>, <span class="st">&quot;y0&quot;</span>, <span class="st">&quot;r&quot;</span>, <span class="st">&quot;phi&quot;</span>, <span class="st">&quot;y_pred&quot;</span>), <span class="at">n.iter =</span> <span class="dv">10000</span>)</span>
<span id="cb40-48"><a href="welcome-to-day-3.html#cb40-48" tabindex="-1"></a></span>
<span id="cb40-49"><a href="welcome-to-day-3.html#cb40-49" tabindex="-1"></a><span class="co"># Extract draws</span></span>
<span id="cb40-50"><a href="welcome-to-day-3.html#cb40-50" tabindex="-1"></a><span class="do">## Parameters</span></span>
<span id="cb40-51"><a href="welcome-to-day-3.html#cb40-51" tabindex="-1"></a>par_post <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(samples[,<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>)])</span>
<span id="cb40-52"><a href="welcome-to-day-3.html#cb40-52" tabindex="-1"></a></span>
<span id="cb40-53"><a href="welcome-to-day-3.html#cb40-53" tabindex="-1"></a><span class="do">## Predictions</span></span>
<span id="cb40-54"><a href="welcome-to-day-3.html#cb40-54" tabindex="-1"></a>pred_post <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(samples[,<span class="fu">c</span>(<span class="dv">5</span><span class="sc">:</span><span class="dv">61</span>)])</span></code></pre></div>
</details>
<p>How the predictions (expected value) looks like with 95% Posterior Predictive Interval<a href="#fn9" class="footnote-ref" id="fnref9"><sup>9</sup></a>:</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="welcome-to-day-3.html#cb41-1" tabindex="-1"></a><span class="co"># Quantiles for 95% Credible Interval</span></span>
<span id="cb41-2"><a href="welcome-to-day-3.html#cb41-2" tabindex="-1"></a>quant <span class="ot">&lt;-</span> <span class="fu">apply</span>(pred_post, <span class="dv">2</span>, quantile, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))</span>
<span id="cb41-3"><a href="welcome-to-day-3.html#cb41-3" tabindex="-1"></a></span>
<span id="cb41-4"><a href="welcome-to-day-3.html#cb41-4" tabindex="-1"></a><span class="co"># DF for prediction</span></span>
<span id="cb41-5"><a href="welcome-to-day-3.html#cb41-5" tabindex="-1"></a>bay_pred <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb41-6"><a href="welcome-to-day-3.html#cb41-6" tabindex="-1"></a>  <span class="at">y.pred =</span> <span class="fu">colMeans</span>(pred_post),</span>
<span id="cb41-7"><a href="welcome-to-day-3.html#cb41-7" tabindex="-1"></a>  <span class="at">y.lb =</span> quant[<span class="dv">1</span>,],</span>
<span id="cb41-8"><a href="welcome-to-day-3.html#cb41-8" tabindex="-1"></a>  <span class="at">y.ub =</span> quant[<span class="dv">2</span>,],</span>
<span id="cb41-9"><a href="welcome-to-day-3.html#cb41-9" tabindex="-1"></a>  <span class="at">x.pred =</span> x.pred</span>
<span id="cb41-10"><a href="welcome-to-day-3.html#cb41-10" tabindex="-1"></a>)</span>
<span id="cb41-11"><a href="welcome-to-day-3.html#cb41-11" tabindex="-1"></a></span>
<span id="cb41-12"><a href="welcome-to-day-3.html#cb41-12" tabindex="-1"></a><span class="co"># Plot prediction</span></span>
<span id="cb41-13"><a href="welcome-to-day-3.html#cb41-13" tabindex="-1"></a><span class="fu">plot</span>(bay_pred<span class="sc">$</span>x.pred, bay_pred<span class="sc">$</span>y.pred, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Pred. severity (mean)&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Days&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="fl">1.1</span>), <span class="at">lwd =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="st">&#39;red&#39;</span>)</span>
<span id="cb41-14"><a href="welcome-to-day-3.html#cb41-14" tabindex="-1"></a><span class="fu">lines</span>(bay_pred<span class="sc">$</span>x.pred, bay_pred<span class="sc">$</span>y.lb, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="st">&#39;red&#39;</span>)</span>
<span id="cb41-15"><a href="welcome-to-day-3.html#cb41-15" tabindex="-1"></a><span class="fu">lines</span>(bay_pred<span class="sc">$</span>x.pred, bay_pred<span class="sc">$</span>y.ub, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="st">&#39;red&#39;</span>)</span>
<span id="cb41-16"><a href="welcome-to-day-3.html#cb41-16" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">1</span>, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="st">&#39;black&#39;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb41-17"><a href="welcome-to-day-3.html#cb41-17" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="st">&#39;black&#39;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
</details>
<p><img src="_main_files/figure-html/unnamed-chunk-62-1.png" alt="" width="672" /></p>
<p>How about the parameters?</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="welcome-to-day-3.html#cb42-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb42-2"><a href="welcome-to-day-3.html#cb42-2" tabindex="-1"></a><span class="co"># For K</span></span>
<span id="cb42-3"><a href="welcome-to-day-3.html#cb42-3" tabindex="-1"></a><span class="fu">hist</span>(par_post[,<span class="dv">1</span>], <span class="at">ylab =</span> <span class="st">&quot;[K]&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;K&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Post. dist. K&quot;</span>, <span class="at">freq =</span> <span class="cn">FALSE</span>)</span>
<span id="cb42-4"><a href="welcome-to-day-3.html#cb42-4" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">mean</span>(par_post[,<span class="dv">1</span>]), <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="st">&#39;red&#39;</span>)</span>
<span id="cb42-5"><a href="welcome-to-day-3.html#cb42-5" tabindex="-1"></a></span>
<span id="cb42-6"><a href="welcome-to-day-3.html#cb42-6" tabindex="-1"></a><span class="co"># For r</span></span>
<span id="cb42-7"><a href="welcome-to-day-3.html#cb42-7" tabindex="-1"></a><span class="fu">hist</span>(par_post[,<span class="dv">3</span>], <span class="at">ylab =</span> <span class="st">&quot;[r]&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;r&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Post. dist. r&quot;</span>, <span class="at">freq =</span> <span class="cn">FALSE</span>)</span>
<span id="cb42-8"><a href="welcome-to-day-3.html#cb42-8" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">mean</span>(par_post[,<span class="dv">3</span>]), <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="st">&#39;red&#39;</span>)</span>
<span id="cb42-9"><a href="welcome-to-day-3.html#cb42-9" tabindex="-1"></a></span>
<span id="cb42-10"><a href="welcome-to-day-3.html#cb42-10" tabindex="-1"></a><span class="co"># For y0</span></span>
<span id="cb42-11"><a href="welcome-to-day-3.html#cb42-11" tabindex="-1"></a><span class="fu">hist</span>(par_post[,<span class="dv">4</span>], <span class="at">ylab =</span> <span class="st">&quot;[y0]&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;y0&quot;</span>, , <span class="at">main =</span> <span class="st">&quot;Post. dist. y0&quot;</span>, <span class="at">freq =</span> <span class="cn">FALSE</span>)</span>
<span id="cb42-12"><a href="welcome-to-day-3.html#cb42-12" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">mean</span>(par_post[,<span class="dv">4</span>]), <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="st">&#39;red&#39;</span>)</span>
<span id="cb42-13"><a href="welcome-to-day-3.html#cb42-13" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
</details>
<p><img src="_main_files/figure-html/unnamed-chunk-63-1.png" alt="" width="672" /></p>
<p>How posterior compare to prior?</p>
<ul>
<li><p>Let’s look at <span class="math inline">\(r\)</span>.</p></li>
<li><p>Recall: <span class="math inline">\(r \sim Unif(0.1, 0.5)\)</span></p></li>
</ul>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="welcome-to-day-3.html#cb43-1" tabindex="-1"></a><span class="co"># Post. dist. r</span></span>
<span id="cb43-2"><a href="welcome-to-day-3.html#cb43-2" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">runif</span>(<span class="dv">1000</span>,<span class="fl">0.1</span>, <span class="fl">0.5</span>), <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">main =</span> <span class="st">&quot;Prior dist. r&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;[r]&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;r&quot;</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.5</span>))</span></code></pre></div>
</details>
<p><img src="_main_files/figure-html/unnamed-chunk-64-1.png" alt="" width="672" /></p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="welcome-to-day-3.html#cb44-1" tabindex="-1"></a><span class="co"># Pior dist. r</span></span>
<span id="cb44-2"><a href="welcome-to-day-3.html#cb44-2" tabindex="-1"></a><span class="fu">hist</span>(par_post[,<span class="dv">3</span>], <span class="at">ylab =</span> <span class="st">&quot;[r]&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;r&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Posterior dist. r&quot;</span>, <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.5</span>))</span></code></pre></div>
</details>
<p><img src="_main_files/figure-html/unnamed-chunk-64-2.png" alt="" width="672" /></p>
<p><br><br></p>
</div>
<div id="why-use-bayesian-1" class="section level4 hasAnchor">
<h4>Why use Bayesian?<a href="welcome-to-day-3.html#why-use-bayesian-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>Let’s use variety a in 2023.</li>
</ul>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="welcome-to-day-3.html#cb45-1" tabindex="-1"></a><span class="do">#### Fit the Bayesian model for 2024 var a ####</span></span>
<span id="cb45-2"><a href="welcome-to-day-3.html#cb45-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2026</span>)</span>
<span id="cb45-3"><a href="welcome-to-day-3.html#cb45-3" tabindex="-1"></a><span class="fu">library</span>(rjags)</span>
<span id="cb45-4"><a href="welcome-to-day-3.html#cb45-4" tabindex="-1"></a></span>
<span id="cb45-5"><a href="welcome-to-day-3.html#cb45-5" tabindex="-1"></a>y <span class="ot">&lt;-</span> df[<span class="fu">which</span>(df<span class="sc">$</span>year <span class="sc">==</span> <span class="dv">2023</span> <span class="sc">&amp;</span> df<span class="sc">$</span>var <span class="sc">==</span> <span class="st">&quot;a&quot;</span>),]<span class="sc">$</span>p_sev <span class="sc">+</span> <span class="fl">0.001</span></span>
<span id="cb45-6"><a href="welcome-to-day-3.html#cb45-6" tabindex="-1"></a>x <span class="ot">&lt;-</span> df[<span class="fu">which</span>(df<span class="sc">$</span>year <span class="sc">==</span> <span class="dv">2023</span> <span class="sc">&amp;</span> df<span class="sc">$</span>var <span class="sc">==</span> <span class="st">&quot;a&quot;</span>),]<span class="sc">$</span>time</span>
<span id="cb45-7"><a href="welcome-to-day-3.html#cb45-7" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">nrow</span>(df[<span class="fu">which</span>(df<span class="sc">$</span>year <span class="sc">==</span> <span class="dv">2023</span> <span class="sc">&amp;</span> df<span class="sc">$</span>var <span class="sc">==</span> <span class="st">&quot;a&quot;</span>),])</span>
<span id="cb45-8"><a href="welcome-to-day-3.html#cb45-8" tabindex="-1"></a>x.pred <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">max</span>(x)<span class="sc">+</span><span class="dv">20</span>, <span class="at">by =</span> <span class="dv">1</span>)</span>
<span id="cb45-9"><a href="welcome-to-day-3.html#cb45-9" tabindex="-1"></a>N_pred <span class="ot">&lt;-</span> <span class="fu">length</span>(x.pred)</span>
<span id="cb45-10"><a href="welcome-to-day-3.html#cb45-10" tabindex="-1"></a></span>
<span id="cb45-11"><a href="welcome-to-day-3.html#cb45-11" tabindex="-1"></a><span class="co"># JAGS code</span></span>
<span id="cb45-12"><a href="welcome-to-day-3.html#cb45-12" tabindex="-1"></a>data_line <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;y&quot;</span> <span class="ot">=</span> y, <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x, <span class="st">&quot;x.pred&quot;</span> <span class="ot">=</span> x.pred, <span class="st">&quot;N&quot;</span> <span class="ot">=</span> N, <span class="st">&quot;N_pred&quot;</span> <span class="ot">=</span> N_pred)</span>
<span id="cb45-13"><a href="welcome-to-day-3.html#cb45-13" tabindex="-1"></a>initials <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb45-14"><a href="welcome-to-day-3.html#cb45-14" tabindex="-1"></a>  <span class="fu">list</span>(<span class="st">&quot;K&quot;</span> <span class="ot">=</span> <span class="fl">0.7</span>, <span class="st">&quot;r&quot;</span> <span class="ot">=</span> <span class="fl">0.2</span>, <span class="st">&quot;y0&quot;</span> <span class="ot">=</span> <span class="fl">0.001</span>, <span class="st">&quot;phi&quot;</span> <span class="ot">=</span> <span class="dv">10</span>)</span>
<span id="cb45-15"><a href="welcome-to-day-3.html#cb45-15" tabindex="-1"></a>)</span>
<span id="cb45-16"><a href="welcome-to-day-3.html#cb45-16" tabindex="-1"></a></span>
<span id="cb45-17"><a href="welcome-to-day-3.html#cb45-17" tabindex="-1"></a>model_string <span class="ot">&lt;-</span> <span class="st">&quot;model {</span></span>
<span id="cb45-18"><a href="welcome-to-day-3.html#cb45-18" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb45-19"><a href="welcome-to-day-3.html#cb45-19" tabindex="-1"></a><span class="st">    # Likelihood</span></span>
<span id="cb45-20"><a href="welcome-to-day-3.html#cb45-20" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb45-21"><a href="welcome-to-day-3.html#cb45-21" tabindex="-1"></a><span class="st">    for(i in 1:N){</span></span>
<span id="cb45-22"><a href="welcome-to-day-3.html#cb45-22" tabindex="-1"></a><span class="st">      y[i] ~ dbeta(alpha[i], beta[i])</span></span>
<span id="cb45-23"><a href="welcome-to-day-3.html#cb45-23" tabindex="-1"></a><span class="st">      alpha[i] &lt;- (K/(1 + ((K-y0)/y0)*exp(-r*x[i])))*phi</span></span>
<span id="cb45-24"><a href="welcome-to-day-3.html#cb45-24" tabindex="-1"></a><span class="st">      beta[i] &lt;- (1-(K/(1 + ((K-y0)/y0)*exp(-r*x[i]))))*phi</span></span>
<span id="cb45-25"><a href="welcome-to-day-3.html#cb45-25" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb45-26"><a href="welcome-to-day-3.html#cb45-26" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb45-27"><a href="welcome-to-day-3.html#cb45-27" tabindex="-1"></a><span class="st">    # Posterior pred.</span></span>
<span id="cb45-28"><a href="welcome-to-day-3.html#cb45-28" tabindex="-1"></a><span class="st">      for(z in 1:N_pred){</span></span>
<span id="cb45-29"><a href="welcome-to-day-3.html#cb45-29" tabindex="-1"></a><span class="st">        y_pred[z] ~ dbeta(alpha_pred[z], beta_pred[z])</span></span>
<span id="cb45-30"><a href="welcome-to-day-3.html#cb45-30" tabindex="-1"></a><span class="st">        alpha_pred[z] &lt;- (K/(1 + ((K-y0)/y0)*exp(-r*x.pred[z])))*phi</span></span>
<span id="cb45-31"><a href="welcome-to-day-3.html#cb45-31" tabindex="-1"></a><span class="st">        beta_pred[z] &lt;- (1-(K/(1 + ((K-y0)/y0)*exp(-r*x.pred[z]))))*phi</span></span>
<span id="cb45-32"><a href="welcome-to-day-3.html#cb45-32" tabindex="-1"></a><span class="st">      }</span></span>
<span id="cb45-33"><a href="welcome-to-day-3.html#cb45-33" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb45-34"><a href="welcome-to-day-3.html#cb45-34" tabindex="-1"></a><span class="st">    # Priors</span></span>
<span id="cb45-35"><a href="welcome-to-day-3.html#cb45-35" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb45-36"><a href="welcome-to-day-3.html#cb45-36" tabindex="-1"></a><span class="st">    y0 ~ dunif(0.001, 0.1)</span></span>
<span id="cb45-37"><a href="welcome-to-day-3.html#cb45-37" tabindex="-1"></a><span class="st">    K ~ dbeta(6, 2)</span></span>
<span id="cb45-38"><a href="welcome-to-day-3.html#cb45-38" tabindex="-1"></a><span class="st">    r ~ dunif(0.1, 0.5)</span></span>
<span id="cb45-39"><a href="welcome-to-day-3.html#cb45-39" tabindex="-1"></a><span class="st">    phi ~ dgamma(24, 2)</span></span>
<span id="cb45-40"><a href="welcome-to-day-3.html#cb45-40" tabindex="-1"></a><span class="st">}&quot;</span></span>
<span id="cb45-41"><a href="welcome-to-day-3.html#cb45-41" tabindex="-1"></a></span>
<span id="cb45-42"><a href="welcome-to-day-3.html#cb45-42" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">jags.model</span>(<span class="fu">textConnection</span>(model_string), <span class="at">inits =</span> initials, <span class="at">data =</span> data_line, <span class="at">n.chains =</span> <span class="dv">1</span>)</span>
<span id="cb45-43"><a href="welcome-to-day-3.html#cb45-43" tabindex="-1"></a></span>
<span id="cb45-44"><a href="welcome-to-day-3.html#cb45-44" tabindex="-1"></a><span class="fu">update</span>(m2, <span class="at">n.iter =</span> <span class="dv">10000</span>)</span>
<span id="cb45-45"><a href="welcome-to-day-3.html#cb45-45" tabindex="-1"></a></span>
<span id="cb45-46"><a href="welcome-to-day-3.html#cb45-46" tabindex="-1"></a>samples <span class="ot">&lt;-</span> <span class="fu">coda.samples</span>(m2, <span class="at">variable.names =</span> <span class="fu">c</span>(<span class="st">&quot;K&quot;</span>, <span class="st">&quot;y0&quot;</span>, <span class="st">&quot;r&quot;</span>, <span class="st">&quot;phi&quot;</span>, <span class="st">&quot;y_pred&quot;</span>), <span class="at">n.iter =</span> <span class="dv">10000</span>)</span>
<span id="cb45-47"><a href="welcome-to-day-3.html#cb45-47" tabindex="-1"></a></span>
<span id="cb45-48"><a href="welcome-to-day-3.html#cb45-48" tabindex="-1"></a><span class="co"># Extract draws</span></span>
<span id="cb45-49"><a href="welcome-to-day-3.html#cb45-49" tabindex="-1"></a><span class="do">## Parameters</span></span>
<span id="cb45-50"><a href="welcome-to-day-3.html#cb45-50" tabindex="-1"></a>par_post <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(samples[,<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>)])</span>
<span id="cb45-51"><a href="welcome-to-day-3.html#cb45-51" tabindex="-1"></a></span>
<span id="cb45-52"><a href="welcome-to-day-3.html#cb45-52" tabindex="-1"></a><span class="do">## Predictions</span></span>
<span id="cb45-53"><a href="welcome-to-day-3.html#cb45-53" tabindex="-1"></a>pred_post <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(samples[, <span class="fu">c</span>(<span class="dv">5</span><span class="sc">:</span><span class="dv">77</span>)])</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="welcome-to-day-3.html#cb46-1" tabindex="-1"></a><span class="do">#### Fit the model using likelihood to 2024 var 1 ####</span></span>
<span id="cb46-2"><a href="welcome-to-day-3.html#cb46-2" tabindex="-1"></a>a_24 <span class="ot">&lt;-</span> df[<span class="fu">which</span>(df<span class="sc">$</span>var <span class="sc">==</span> <span class="st">&quot;a&quot;</span> <span class="sc">&amp;</span> df<span class="sc">$</span>year <span class="sc">==</span> <span class="dv">2023</span>),]</span>
<span id="cb46-3"><a href="welcome-to-day-3.html#cb46-3" tabindex="-1"></a></span>
<span id="cb46-4"><a href="welcome-to-day-3.html#cb46-4" tabindex="-1"></a><span class="co"># Fit the model</span></span>
<span id="cb46-5"><a href="welcome-to-day-3.html#cb46-5" tabindex="-1"></a>m3 <span class="ot">&lt;-</span> <span class="fu">nls</span>(p_sev <span class="sc">~</span> K<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>((K<span class="sc">-</span>y0)<span class="sc">/</span>y0)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>r<span class="sc">*</span>time)), <span class="at">start =</span> <span class="fu">c</span>(<span class="at">K =</span> <span class="fl">0.7</span>, <span class="at">r =</span> <span class="fl">0.2</span>, <span class="at">y0 =</span> <span class="fl">0.001</span>), <span class="at">data =</span> a_24)</span>
<span id="cb46-6"><a href="welcome-to-day-3.html#cb46-6" tabindex="-1"></a></span>
<span id="cb46-7"><a href="welcome-to-day-3.html#cb46-7" tabindex="-1"></a><span class="co"># Predictions with prediction interval</span></span>
<span id="cb46-8"><a href="welcome-to-day-3.html#cb46-8" tabindex="-1"></a>df_pred <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb46-9"><a href="welcome-to-day-3.html#cb46-9" tabindex="-1"></a>  <span class="at">time =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">max</span>(a_24<span class="sc">$</span>time)<span class="sc">+</span><span class="dv">20</span>, <span class="at">by =</span> <span class="dv">1</span>)</span>
<span id="cb46-10"><a href="welcome-to-day-3.html#cb46-10" tabindex="-1"></a>)</span>
<span id="cb46-11"><a href="welcome-to-day-3.html#cb46-11" tabindex="-1"></a></span>
<span id="cb46-12"><a href="welcome-to-day-3.html#cb46-12" tabindex="-1"></a><span class="fu">library</span>(mvtnorm) <span class="co"># Package for multivariate normal</span></span>
<span id="cb46-13"><a href="welcome-to-day-3.html#cb46-13" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2026</span>)</span>
<span id="cb46-14"><a href="welcome-to-day-3.html#cb46-14" tabindex="-1"></a></span>
<span id="cb46-15"><a href="welcome-to-day-3.html#cb46-15" tabindex="-1"></a>ite <span class="ot">&lt;-</span> <span class="dv">10000</span> <span class="co"># Number of iterations/simulations</span></span>
<span id="cb46-16"><a href="welcome-to-day-3.html#cb46-16" tabindex="-1"></a></span>
<span id="cb46-17"><a href="welcome-to-day-3.html#cb46-17" tabindex="-1"></a>par_hat <span class="ot">&lt;-</span> <span class="fu">coef</span>(m3) <span class="co"># Extract parameter estimated</span></span>
<span id="cb46-18"><a href="welcome-to-day-3.html#cb46-18" tabindex="-1"></a>var_cov <span class="ot">&lt;-</span> <span class="fu">vcov</span>(m3) <span class="co"># Extract var covar matrix</span></span>
<span id="cb46-19"><a href="welcome-to-day-3.html#cb46-19" tabindex="-1"></a>sigma_hat <span class="ot">&lt;-</span> <span class="fu">summary</span>(m3)<span class="sc">$</span>sigma <span class="co"># Extract standard deviation</span></span>
<span id="cb46-20"><a href="welcome-to-day-3.html#cb46-20" tabindex="-1"></a></span>
<span id="cb46-21"><a href="welcome-to-day-3.html#cb46-21" tabindex="-1"></a>par_sim <span class="ot">&lt;-</span> <span class="fu">rmvnorm</span>(ite, par_hat, var_cov) <span class="co"># Simulate parameters - Draws from a multivariate normal using our expected value for the parameter and their variance</span></span>
<span id="cb46-22"><a href="welcome-to-day-3.html#cb46-22" tabindex="-1"></a></span>
<span id="cb46-23"><a href="welcome-to-day-3.html#cb46-23" tabindex="-1"></a>time <span class="ot">&lt;-</span> df_pred<span class="sc">$</span>time</span>
<span id="cb46-24"><a href="welcome-to-day-3.html#cb46-24" tabindex="-1"></a></span>
<span id="cb46-25"><a href="welcome-to-day-3.html#cb46-25" tabindex="-1"></a>sim.save <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> ite, <span class="at">ncol =</span> <span class="fu">length</span>(time))</span>
<span id="cb46-26"><a href="welcome-to-day-3.html#cb46-26" tabindex="-1"></a></span>
<span id="cb46-27"><a href="welcome-to-day-3.html#cb46-27" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>ite){</span>
<span id="cb46-28"><a href="welcome-to-day-3.html#cb46-28" tabindex="-1"></a>  </span>
<span id="cb46-29"><a href="welcome-to-day-3.html#cb46-29" tabindex="-1"></a>  K <span class="ot">&lt;-</span> par_sim[i,<span class="st">&quot;K&quot;</span>]</span>
<span id="cb46-30"><a href="welcome-to-day-3.html#cb46-30" tabindex="-1"></a>  y0 <span class="ot">&lt;-</span> par_sim[i, <span class="st">&quot;y0&quot;</span>]</span>
<span id="cb46-31"><a href="welcome-to-day-3.html#cb46-31" tabindex="-1"></a>  r <span class="ot">&lt;-</span> par_sim[i, <span class="st">&quot;r&quot;</span>]</span>
<span id="cb46-32"><a href="welcome-to-day-3.html#cb46-32" tabindex="-1"></a>    </span>
<span id="cb46-33"><a href="welcome-to-day-3.html#cb46-33" tabindex="-1"></a>  mu <span class="ot">&lt;-</span> K<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>((K<span class="sc">-</span>y0)<span class="sc">/</span>y0)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>r<span class="sc">*</span>time))</span>
<span id="cb46-34"><a href="welcome-to-day-3.html#cb46-34" tabindex="-1"></a>  </span>
<span id="cb46-35"><a href="welcome-to-day-3.html#cb46-35" tabindex="-1"></a>  sim.save[i,] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(time), mu, sigma_hat)</span>
<span id="cb46-36"><a href="welcome-to-day-3.html#cb46-36" tabindex="-1"></a>  </span>
<span id="cb46-37"><a href="welcome-to-day-3.html#cb46-37" tabindex="-1"></a>}</span>
<span id="cb46-38"><a href="welcome-to-day-3.html#cb46-38" tabindex="-1"></a></span>
<span id="cb46-39"><a href="welcome-to-day-3.html#cb46-39" tabindex="-1"></a><span class="co"># Prediction + pred intervals on the df</span></span>
<span id="cb46-40"><a href="welcome-to-day-3.html#cb46-40" tabindex="-1"></a>df_pred<span class="sc">$</span>pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(m3, <span class="at">newdata =</span> df_pred)</span>
<span id="cb46-41"><a href="welcome-to-day-3.html#cb46-41" tabindex="-1"></a>df_pred<span class="sc">$</span>pred_ub <span class="ot">&lt;-</span> <span class="fu">apply</span>(sim.save, <span class="dv">2</span>, quantile, <span class="fl">0.975</span>)</span>
<span id="cb46-42"><a href="welcome-to-day-3.html#cb46-42" tabindex="-1"></a>df_pred<span class="sc">$</span>pred_lb <span class="ot">&lt;-</span> <span class="fu">apply</span>(sim.save, <span class="dv">2</span>, quantile, <span class="fl">0.025</span>)</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="welcome-to-day-3.html#cb47-1" tabindex="-1"></a><span class="co"># Plot predictions with interval for iid normal assumption</span></span>
<span id="cb47-2"><a href="welcome-to-day-3.html#cb47-2" tabindex="-1"></a><span class="fu">plot</span>(a_24<span class="sc">$</span>time, a_24<span class="sc">$</span>p_sev, <span class="at">ylab =</span> <span class="st">&quot;Severity (prop.)&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Days&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Likelihood approach with minimal assumptions&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">1.1</span>))</span>
<span id="cb47-3"><a href="welcome-to-day-3.html#cb47-3" tabindex="-1"></a><span class="fu">lines</span>(df_pred<span class="sc">$</span>time, df_pred<span class="sc">$</span>pred, <span class="at">lwd =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="st">&#39;red&#39;</span>)</span>
<span id="cb47-4"><a href="welcome-to-day-3.html#cb47-4" tabindex="-1"></a><span class="fu">lines</span>(df_pred<span class="sc">$</span>time, df_pred<span class="sc">$</span>pred_ub, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&#39;red&#39;</span>)</span>
<span id="cb47-5"><a href="welcome-to-day-3.html#cb47-5" tabindex="-1"></a><span class="fu">lines</span>(df_pred<span class="sc">$</span>time, df_pred<span class="sc">$</span>pred_lb, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&#39;red&#39;</span>)</span></code></pre></div>
</details>
<p><img src="_main_files/figure-html/unnamed-chunk-67-1.png" alt="" width="672" /></p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="welcome-to-day-3.html#cb48-1" tabindex="-1"></a><span class="co"># Plot predictions with interval for Bayesian model</span></span>
<span id="cb48-2"><a href="welcome-to-day-3.html#cb48-2" tabindex="-1"></a><span class="co"># Quantiles for 95% Credible Interval</span></span>
<span id="cb48-3"><a href="welcome-to-day-3.html#cb48-3" tabindex="-1"></a>quant <span class="ot">&lt;-</span> <span class="fu">apply</span>(pred_post, <span class="dv">2</span>, quantile, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))</span>
<span id="cb48-4"><a href="welcome-to-day-3.html#cb48-4" tabindex="-1"></a></span>
<span id="cb48-5"><a href="welcome-to-day-3.html#cb48-5" tabindex="-1"></a><span class="co"># DF for prediction</span></span>
<span id="cb48-6"><a href="welcome-to-day-3.html#cb48-6" tabindex="-1"></a>bay_pred <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb48-7"><a href="welcome-to-day-3.html#cb48-7" tabindex="-1"></a>  <span class="at">y.pred =</span> <span class="fu">colMeans</span>(pred_post),</span>
<span id="cb48-8"><a href="welcome-to-day-3.html#cb48-8" tabindex="-1"></a>  <span class="at">y.lb =</span> quant[<span class="dv">1</span>,],</span>
<span id="cb48-9"><a href="welcome-to-day-3.html#cb48-9" tabindex="-1"></a>  <span class="at">y.ub =</span> quant[<span class="dv">2</span>,],</span>
<span id="cb48-10"><a href="welcome-to-day-3.html#cb48-10" tabindex="-1"></a>  <span class="at">x.pred =</span> x.pred</span>
<span id="cb48-11"><a href="welcome-to-day-3.html#cb48-11" tabindex="-1"></a>)</span>
<span id="cb48-12"><a href="welcome-to-day-3.html#cb48-12" tabindex="-1"></a></span>
<span id="cb48-13"><a href="welcome-to-day-3.html#cb48-13" tabindex="-1"></a><span class="co"># Plot prediction</span></span>
<span id="cb48-14"><a href="welcome-to-day-3.html#cb48-14" tabindex="-1"></a><span class="fu">plot</span>(x, y, <span class="at">ylab =</span> <span class="st">&quot;Severity (prop.)&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Days&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Bayesian model&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="fl">1.1</span>))</span>
<span id="cb48-15"><a href="welcome-to-day-3.html#cb48-15" tabindex="-1"></a><span class="fu">lines</span>(bay_pred<span class="sc">$</span>x.pred, bay_pred<span class="sc">$</span>y.pred, <span class="at">lwd =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="st">&#39;red&#39;</span>)</span>
<span id="cb48-16"><a href="welcome-to-day-3.html#cb48-16" tabindex="-1"></a><span class="fu">lines</span>(bay_pred<span class="sc">$</span>x.pred, bay_pred<span class="sc">$</span>y.lb, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&#39;red&#39;</span>)</span>
<span id="cb48-17"><a href="welcome-to-day-3.html#cb48-17" tabindex="-1"></a><span class="fu">lines</span>(bay_pred<span class="sc">$</span>x.pred, bay_pred<span class="sc">$</span>y.ub, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&#39;red&#39;</span>)</span></code></pre></div>
</details>
<p><img src="_main_files/figure-html/unnamed-chunk-67-2.png" alt="" width="672" /></p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="welcome-to-day-3.html#cb49-1" tabindex="-1"></a><span class="co"># Likelihood uncertainty width</span></span>
<span id="cb49-2"><a href="welcome-to-day-3.html#cb49-2" tabindex="-1"></a>lt1 <span class="ot">&lt;-</span> df_pred<span class="sc">$</span>pred_ub[<span class="dv">1</span>] <span class="sc">-</span> df_pred<span class="sc">$</span>pred_lb[<span class="dv">1</span>]</span>
<span id="cb49-3"><a href="welcome-to-day-3.html#cb49-3" tabindex="-1"></a>lt2 <span class="ot">&lt;-</span> df_pred<span class="sc">$</span>pred_ub[<span class="dv">37</span>] <span class="sc">-</span> df_pred<span class="sc">$</span>pred_lb[<span class="dv">37</span>]</span>
<span id="cb49-4"><a href="welcome-to-day-3.html#cb49-4" tabindex="-1"></a>lt3 <span class="ot">&lt;-</span> df_pred<span class="sc">$</span>pred_ub[<span class="dv">73</span>] <span class="sc">-</span> df_pred<span class="sc">$</span>pred_lb[<span class="dv">73</span>]</span>
<span id="cb49-5"><a href="welcome-to-day-3.html#cb49-5" tabindex="-1"></a></span>
<span id="cb49-6"><a href="welcome-to-day-3.html#cb49-6" tabindex="-1"></a><span class="co"># Bayesian uncertainty width</span></span>
<span id="cb49-7"><a href="welcome-to-day-3.html#cb49-7" tabindex="-1"></a>bt1 <span class="ot">&lt;-</span> bay_pred<span class="sc">$</span>y.ub[<span class="dv">1</span>] <span class="sc">-</span> bay_pred<span class="sc">$</span>y.lb[<span class="dv">1</span>]</span>
<span id="cb49-8"><a href="welcome-to-day-3.html#cb49-8" tabindex="-1"></a>bt2 <span class="ot">&lt;-</span> bay_pred<span class="sc">$</span>y.ub[<span class="dv">37</span>] <span class="sc">-</span> bay_pred<span class="sc">$</span>y.lb[<span class="dv">37</span>]</span>
<span id="cb49-9"><a href="welcome-to-day-3.html#cb49-9" tabindex="-1"></a>bt3 <span class="ot">&lt;-</span> bay_pred<span class="sc">$</span>y.ub[<span class="dv">73</span>] <span class="sc">-</span> bay_pred<span class="sc">$</span>y.lb[<span class="dv">73</span>]</span>
<span id="cb49-10"><a href="welcome-to-day-3.html#cb49-10" tabindex="-1"></a></span>
<span id="cb49-11"><a href="welcome-to-day-3.html#cb49-11" tabindex="-1"></a><span class="co"># Table with distance</span></span>
<span id="cb49-12"><a href="welcome-to-day-3.html#cb49-12" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb49-13"><a href="welcome-to-day-3.html#cb49-13" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb49-14"><a href="welcome-to-day-3.html#cb49-14" tabindex="-1"></a></span>
<span id="cb49-15"><a href="welcome-to-day-3.html#cb49-15" tabindex="-1"></a>table_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb49-16"><a href="welcome-to-day-3.html#cb49-16" tabindex="-1"></a>  <span class="at">Estimation =</span> <span class="fu">c</span>(<span class="st">&quot;Min. Assump.&quot;</span>, <span class="st">&quot;Bayesian&quot;</span>),</span>
<span id="cb49-17"><a href="welcome-to-day-3.html#cb49-17" tabindex="-1"></a>  <span class="at">Day_1_Width =</span> <span class="fu">c</span>(<span class="fu">round</span>(lt1, <span class="dv">4</span>), <span class="fu">round</span>(bt1, <span class="dv">4</span>)),</span>
<span id="cb49-18"><a href="welcome-to-day-3.html#cb49-18" tabindex="-1"></a>  <span class="at">Relative_uncertainty =</span> <span class="fu">c</span>(<span class="st">&quot; &quot;</span>, <span class="fu">round</span>((bt1<span class="sc">/</span>lt1)<span class="sc">*</span><span class="dv">100</span>, <span class="dv">2</span>)),</span>
<span id="cb49-19"><a href="welcome-to-day-3.html#cb49-19" tabindex="-1"></a>  <span class="at">Day_37_Width =</span> <span class="fu">c</span>(<span class="fu">round</span>(lt2, <span class="dv">4</span>), <span class="fu">round</span>(bt2, <span class="dv">4</span>)),</span>
<span id="cb49-20"><a href="welcome-to-day-3.html#cb49-20" tabindex="-1"></a>  <span class="at">Relative_uncertainty =</span> <span class="fu">c</span>(<span class="st">&quot; &quot;</span>, <span class="fu">round</span>((bt2<span class="sc">/</span>lt2)<span class="sc">*</span><span class="dv">100</span>, <span class="dv">2</span>)),</span>
<span id="cb49-21"><a href="welcome-to-day-3.html#cb49-21" tabindex="-1"></a>  <span class="at">Day_73_Width =</span> <span class="fu">c</span>(<span class="fu">round</span>(lt3, <span class="dv">4</span>), <span class="fu">round</span>(bt3, <span class="dv">4</span>)),</span>
<span id="cb49-22"><a href="welcome-to-day-3.html#cb49-22" tabindex="-1"></a>  <span class="at">Relative_uncertainty =</span> <span class="fu">c</span>(<span class="st">&quot; &quot;</span>, <span class="fu">round</span>((bt3<span class="sc">/</span>lt3)<span class="sc">*</span><span class="dv">100</span>, <span class="dv">2</span>))</span>
<span id="cb49-23"><a href="welcome-to-day-3.html#cb49-23" tabindex="-1"></a>)</span>
<span id="cb49-24"><a href="welcome-to-day-3.html#cb49-24" tabindex="-1"></a></span>
<span id="cb49-25"><a href="welcome-to-day-3.html#cb49-25" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(table_data, <span class="at">align =</span> <span class="st">&quot;c&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb49-26"><a href="welcome-to-day-3.html#cb49-26" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">full_width =</span> <span class="cn">TRUE</span>, <span class="at">position =</span> <span class="st">&quot;center&quot;</span>)</span></code></pre></div>
</details>
<table class="table" style="color: black; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;">
Estimation
</th>
<th style="text-align:center;">
Day_1_Width
</th>
<th style="text-align:center;">
Relative_uncertainty
</th>
<th style="text-align:center;">
Day_37_Width
</th>
<th style="text-align:center;">
Relative_uncertainty.1
</th>
<th style="text-align:center;">
Day_73_Width
</th>
<th style="text-align:center;">
Relative_uncertainty.2
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
Min. Assump.
</td>
<td style="text-align:center;">
0.3903
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
0.9748
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
0.9557
</td>
<td style="text-align:center;">
</td>
</tr>
<tr>
<td style="text-align:center;">
Bayesian
</td>
<td style="text-align:center;">
0.0205
</td>
<td style="text-align:center;">
5.25
</td>
<td style="text-align:center;">
0.4055
</td>
<td style="text-align:center;">
41.59
</td>
<td style="text-align:center;">
0.5407
</td>
<td style="text-align:center;">
56.58
</td>
</tr>
</tbody>
</table>
<p>How about the parameters?</p>
<p><img src="_main_files/figure-html/unnamed-chunk-69-1.png" alt="" width="672" /></p>
<p><br><br></p>
<table class="table" style="color: black; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;">
Estimation
</th>
<th style="text-align:center;">
Parameter
</th>
<th style="text-align:center;">
Estimate
</th>
<th style="text-align:center;">
Est_lb
</th>
<th style="text-align:center;">
Est_ub
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
Min. Assump.
</td>
<td style="text-align:center;">
K
</td>
<td style="text-align:center;">
0.6684032
</td>
<td style="text-align:center;">
0.0534314
</td>
<td style="text-align:center;">
1.2833750
</td>
</tr>
<tr>
<td style="text-align:center;">
Min. Assump.
</td>
<td style="text-align:center;">
r
</td>
<td style="text-align:center;">
0.3361402
</td>
<td style="text-align:center;">
-1.0979691
</td>
<td style="text-align:center;">
1.7702495
</td>
</tr>
<tr>
<td style="text-align:center;">
Min. Assump.
</td>
<td style="text-align:center;">
y0
</td>
<td style="text-align:center;">
0.0000002
</td>
<td style="text-align:center;">
-0.0000130
</td>
<td style="text-align:center;">
0.0000134
</td>
</tr>
<tr>
<td style="text-align:center;">
Bayesian
</td>
<td style="text-align:center;">
K
</td>
<td style="text-align:center;">
0.8399081
</td>
<td style="text-align:center;">
0.6217403
</td>
<td style="text-align:center;">
0.9767759
</td>
</tr>
<tr>
<td style="text-align:center;">
Bayesian
</td>
<td style="text-align:center;">
r
</td>
<td style="text-align:center;">
0.1250032
</td>
<td style="text-align:center;">
0.1031462
</td>
<td style="text-align:center;">
0.1436832
</td>
</tr>
<tr>
<td style="text-align:center;">
Bayesian
</td>
<td style="text-align:center;">
y0
</td>
<td style="text-align:center;">
0.0018866
</td>
<td style="text-align:center;">
0.0010216
</td>
<td style="text-align:center;">
0.0042990
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="wrap-up" class="section level3 hasAnchor">
<h3>3. Wrap-up<a href="welcome-to-day-3.html#wrap-up" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>There is no right or wrong! There are different assumptions, and each carry advantages and disadvantages.</p></li>
<li><p>Choosing assumptions should be done consciously, keeping in mind that they might change the analysis results, and how you make inference.</p></li>
<li><p>Bayesian is not a better approach. It is another tool in your toolbox, and might be helpful in some situations.</p>
<ul>
<li><p>Before: Less uncertainty = More data</p></li>
<li><p>Now: Other options -&gt; Less uncertainty = More assumptions</p></li>
</ul></li>
<li><p>All workshop material is available on this page. Feel free to contact us as well if you have questions!</p></li>
<li><p>Thank you very much for you attention and for attending this workshop, this was a great opportunity for us all to learn more together! Stay tuned for the next workshop “<a href="https://www.k-state.edu/engagement/innovation-and-partnerships/interdisciplinary-institutes/digital-ag-advanced-analytics/about/analytics-workshops.html">Bayesian Modeling of Designed Experiments</a>” on March 2, 4, and 5.</p></li>
</ul>

</div>
</div>
</div>



























<div class="footnotes">
<hr />
<ol start="8">
<li id="fn8"><p>By definition, a random variable assigns a numerical value to the outcome of a random experiment.<a href="welcome-to-day-3.html#fnref8" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="welcome-to-day-2.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": null,
    "text": null
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": ["_main.pdf", "_main.epub"],
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection",
    "chapter_name": ""
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
